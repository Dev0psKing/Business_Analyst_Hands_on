<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Excel 365 Course Viewer</title>
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        display: flex;
        height: 100vh;
        background: #f5f5f5;
        transition: background 0.3s, color 0.3s;
    }
    .dark-mode { background: #121212; color: #eee; }
    .dark-mode #sidebar { background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%); }
    .dark-mode .file-item { background: rgba(255,255,255,0.05); }
    .dark-mode .file-item:hover { background: rgba(255,255,255,0.1); }
    .dark-mode #topbar { background: #1f1f1f; border-bottom: 1px solid #333; }
    .dark-mode button { background: #333; color: #eee; }
    .dark-mode button:hover { background: #444; }
    .dark-mode #search { background: #333; color: #eee; }
    .dark-mode #current-file { color: #4ade80; }
    .dark-mode #empty-state { color: #666; }
    #sidebar {
        width: 350px;
        background: linear-gradient(135deg, #217346 0%, #1a5c37 100%);
        color: white;
        overflow-y: auto;
        padding: 20px;
        box-shadow: 2px 0 10px rgba(0,0,0,0.1);
    }
    #sidebar h1 {
        font-size: 22px;
        margin-bottom: 10px;
        padding-bottom: 10px;
        border-bottom: 2px solid rgba(255,255,255,0.3);
    }
    #controls { margin: 15px 0; }
    #search {
        width: 100%;
        padding: 10px;
        border: none;
        border-radius: 5px;
        font-size: 14px;
        margin-bottom: 10px;
    }
    button {
        width: 100%;
        padding: 10px;
        background: white;
        color: #217346;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-weight: bold;
        font-size: 14px;
        margin-bottom: 10px;
        transition: background 0.3s;
    }
    button:hover { background: #e6ffe6; }
    .file-item {
        background: rgba(255,255,255,0.1);
        padding: 12px;
        margin: 8px 0;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s;
        border-left: 3px solid transparent;
    }
    .file-item:hover {
        background: rgba(255,255,255,0.2);
        border-left-color: white;
        transform: translateX(5px);
    }
    .file-item.active {
        background: rgba(255,255,255,0.25);
        border-left-color: #ffd700;
    }
    .file-number { font-weight: bold; margin-right: 8px; opacity: 0.7; }
    .file-time { font-size: 11px; opacity: 0.7; margin-top: 4px; }
    #viewer {
        flex: 1;
        background: white;
        display: flex;
        flex-direction: column;
    }
    #topbar {
        background: white;
        padding: 15px 20px;
        border-bottom: 1px solid #ddd;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    #current-file { font-size: 16px; font-weight: bold; color: #217346; }
    #navigation { display: flex; gap: 10px; }
    .nav-btn {
        padding: 8px 15px;
        background: #217346;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
    }
    .nav-btn:hover { background: #1a5c37; }
    .nav-btn:disabled { background: #ccc; cursor: not-allowed; }
    iframe { flex: 1; border: none; width: 100%; }
    #empty-state {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #999;
        font-size: 18px;
    }
</style>
</head>
<body>
<div id="sidebar">
    <h1>üìö Advanced Excel 365 Course</h1>
    <p id="file-count" style="opacity: 0.8; margin-bottom: 15px; font-size: 14px;">6 Course Files</p>
    <div id="controls">
        <input type="text" id="search" placeholder="üîç Search lessons...">
        <button onclick="openAllTabs()">Open All in Tabs</button>
        <button onclick="toggleDarkMode()">üåô Toggle Dark Mode</button>
    </div>
    <div id="fileList"></div>
</div>
<div id="viewer">
    <div id="topbar">
        <div id="current-file">Select a file to begin</div>
        <div id="navigation">
            <button class="nav-btn" id="prevBtn" onclick="navigatePrev()" disabled>‚Üê Previous</button>
            <button class="nav-btn" id="nextBtn" onclick="navigateNext()" disabled>Next ‚Üí</button>
        </div>
    </div>
    <iframe id="content" style="display:none;"></iframe>
    <div id="empty-state">üëà Select a lesson from the sidebar to start</div>
</div>
<script>
const files = [
    "Practice ExamÔºö 3 ÔΩú 365 Data Science (14_11_2025 10Ôºö15Ôºö22).html",
    "Practice ExamÔºö 3 ÔΩú 365 Data Science (14_11_2025 10Ôºö15Ôºö49).html",
    "Practice ExamÔºö 3 ÔΩú 365 Data Science (14_11_2025 10Ôºö16Ôºö38).html",
    "Practice ExamÔºö 3 ÔΩú 365 Data Science (14_11_2025 10Ôºö17Ôºö26).html",
    "Practice ExamÔºö 3 ÔΩú 365 Data Science (14_11_2025 10Ôºö17Ôºö38).html",
    "Practice ExamÔºö 3 ÔΩú 365 Data Science (14_11_2025 10Ôºö17Ôºö56).html"
];
let currentIndex = -1;

function extractTime(filename) {
    const match = filename.match(/(\d{2}_\d{2}_\d{4})-(\d{2})-(\d{2})-(\d{2})/);
    if (!match) return '';
    const date = match[1].replace(/_/g, '/');
    const time = match[2] + ':' + match[3] + ':' + match[4];
    return date + ' ' + time;
}

function loadFileList() {
    const fileListDiv = document.getElementById('fileList');
    files.forEach((file, index) => {
        const div = document.createElement('div');
        div.className = 'file-item';
        div.innerHTML = `
            <div><span class="file-number">${index + 1}.</span>Lesson ${index + 1}</div>
            <div class="file-time">${extractTime(file)}</div>
        `;
        div.onclick = () => loadFile(index);
        fileListDiv.appendChild(div);
    });
}

function loadFile(index) {
    currentIndex = index;
    const file = files[index];
    document.getElementById('content').src = encodeURI(file);
    document.getElementById('content').style.display = 'block';
    document.getElementById('empty-state').style.display = 'none';
    document.getElementById('current-file').textContent = `Lesson ${index + 1} of ${files.length}`;
    document.querySelectorAll('.file-item').forEach((item, i) => {
        item.classList.toggle('active', i === index);
    });
    document.getElementById('prevBtn').disabled = index === 0;
    document.getElementById('nextBtn').disabled = index === files.length - 1;
    localStorage.setItem("lastLesson", index);
}

function navigatePrev() { if (currentIndex > 0) loadFile(currentIndex - 1); }
function navigateNext() { if (currentIndex < files.length - 1) loadFile(currentIndex + 1); }
function openAllTabs() { for (let file of files) window.open(encodeURI(file), '_blank'); }
function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
    localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
}

document.getElementById('search').addEventListener('input', function() {
    const filter = this.value.toLowerCase();
    document.querySelectorAll('.file-item').forEach((item, index) => {
        const text = `lesson ${index + 1} ${extractTime(files[index])}`.toLowerCase();
        item.style.display = text.includes(filter) ? 'block' : 'none';
    });
});

window.onload = () => {
    loadFileList();
    if (localStorage.getItem('darkMode') === 'true') document.body.classList.add('dark-mode');
    const lastLesson = localStorage.getItem("lastLesson");
    if (lastLesson !== null) loadFile(parseInt(lastLesson));
};
</script>
</body>
</html>